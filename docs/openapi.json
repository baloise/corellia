{
  "openapi" : "3.0.1",
  "info" : {
    "title" : "Contracts API",
    "description" : "An API which allows to communicate with SaaS Providers, which produces Contracts for the host of this API",
    "contact" : {
      "email" : "Group.CH_Open-Source@baloise.ch"
    },
    "license" : {
      "name" : "Apache License 2.0",
      "url" : "https://github.com/baloise/corellia/blob/master/LICENSE.txt"
    },
    "version" : "0.1.0"
  },
  "paths" : {
    "/contracts/v1" : {
      "post" : {
        "tags" : [ "contracts" ],
        "summary" : "upload a contract at Baloise",
        "description" : "uploaded a contract to Baloise. If validation fails processing is refused, a corresponding error is thrown",
        "operationId" : "uploadContract",
        "parameters" : [ {
          "name" : "X-Caller-Name",
          "in" : "header",
          "description" : "identifying the sender of this event (request) ",
          "required" : true,
          "schema" : {
            "type" : "string",
            "description" : "defined by the callee"
          }
        }, {
          "name" : "X-Event-ID",
          "in" : "header",
          "description" : "unique identifier per event (request)",
          "required" : true,
          "schema" : {
            "type" : "string",
            "description" : "generated uuid",
            "format" : "uuid"
          }
        } ],
        "requestBody" : {
          "description" : "Contract that needs to be uploaded to Baloise",
          "content" : {
            "application/json; charset=UTF-8" : {
              "schema" : {
                "$ref" : "#/components/schemas/Contract"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "default" : {
            "description" : "a handle to the contract for conversation with Baloise is provided",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ContractReference"
                }
              }
            }
          },
          "400" : {
            "description" : "Invalid Contract is provided. See Error details for more information about validation issues",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "503" : {
            "description" : "technical issue on our side, please retry later",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contracts/v1/documents" : {
      "post" : {
        "tags" : [ "documents" ],
        "summary" : "upload a Document for a contract at Baloise.",
        "description" : "Please note that this operation needs to be called per document for a contract to be uploaded. The response contains a handle to the document. This handle should be provided with the contract to be uploaded via uploadContract",
        "operationId" : "uploadDocument",
        "parameters" : [ {
          "name" : "X-Caller-Name",
          "in" : "header",
          "description" : "identifying the sender of this event (request) ",
          "required" : true,
          "schema" : {
            "type" : "string",
            "description" : "defined by the callee"
          }
        }, {
          "name" : "X-Event-ID",
          "in" : "header",
          "description" : "unique identifier per event (request)",
          "required" : true,
          "schema" : {
            "type" : "string",
            "description" : "generated uuid",
            "format" : "uuid"
          }
        } ],
        "requestBody" : {
          "description" : "a documnent that is part of a contract",
          "content" : {
            "application/json; charset=UTF-8" : {
              "schema" : {
                "$ref" : "#/components/schemas/Document"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "default" : {
            "description" : "a handle to the document for providing with a new contract to be uploaded via POST contracts",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/FileHandle"
                }
              }
            }
          },
          "400" : {
            "description" : "Invalid Document is provided. See Error details for more information about validation issues",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "503" : {
            "description" : "technical issue on our side, please retry later",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/contracts/v1/version" : {
      "get" : {
        "tags" : [ "version" ],
        "summary" : "callable way of retrieving current version",
        "description" : "callable way (compared to analyzing the URL of the endpoint) of retrieving current version. As well good for testing purposes as operation is get only",
        "operationId" : "version",
        "responses" : {
          "default" : {
            "description" : "version identifier",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Version"
                }
              }
            }
          },
          "503" : {
            "description" : "technical issue on our side, please retry later",
            "content" : {
              "application/json; charset=UTF-8" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components" : {
    "schemas" : {
      "ContractReference" : {
        "type" : "object",
        "properties" : {
          "reference" : {
            "type" : "string",
            "description" : "under this reference the contract is stored at Baloise"
          }
        }
      },
      "ErrorResponse" : {
        "required" : [ "errorCause", "message" ],
        "type" : "object",
        "properties" : {
          "errorCause" : {
            "type" : "string",
            "enum" : [ "httpClientError", "httpClientErrorInputValidation", "httpServerError" ]
          },
          "message" : {
            "type" : "string",
            "description" : "information about the error"
          },
          "detailMessages" : {
            "type" : "array",
            "description" : "in case of e.g. validation error, each validation error is represented by one detail message",
            "items" : {
              "type" : "string"
            }
          }
        }
      },
      "Address" : {
        "required" : [ "city", "houseNumber", "street", "zipCode" ],
        "type" : "object",
        "properties" : {
          "street" : {
            "maxLength" : 35,
            "minLength" : 0,
            "type" : "string"
          },
          "houseNumber" : {
            "maxLength" : 10,
            "minLength" : 0,
            "type" : "string"
          },
          "zipCode" : {
            "maxLength" : 4,
            "minLength" : 4,
            "type" : "string"
          },
          "city" : {
            "maxLength" : 30,
            "minLength" : 0,
            "type" : "string"
          }
        }
      },
      "Agent" : {
        "required" : [ "agentNumber", "email" ],
        "type" : "object",
        "properties" : {
          "agentNumber" : {
            "maxLength" : 8,
            "minLength" : 0,
            "type" : "string",
            "description" : "Identification of an Agent"
          },
          "email" : {
            "maxLength" : 70,
            "minLength" : 2,
            "type" : "string",
            "description" : "A valid email adress"
          }
        },
        "description" : "the agent who induced the contract issuance, usually is eligible for receiving commission"
      },
      "Company" : {
        "required" : [ "address", "contactFirstName", "contactLastName", "contactSalutation", "name" ],
        "type" : "object",
        "properties" : {
          "name" : {
            "maxLength" : 70,
            "minLength" : 3,
            "type" : "string"
          },
          "uidNumber" : {
            "maxLength" : 15,
            "minLength" : 0,
            "type" : "string",
            "description" : "identifies a company uniquely, example CHE-105.805.649"
          },
          "legalForm" : {
            "maxLength" : 2,
            "minLength" : 2,
            "type" : "string",
            "description" : "identifies the legal form of the company by CrediReform codes. Has to be provided if UID is missing.",
            "enum" : [ "PRIVATPERSON", "EINZELUNTERNEHMEN", "GEWERBEBETRIEB", "EINFACHE_GESELLSCHAFT", "KOLLEKTIVGESELLSCHAFT", "KOMMANDITGESELLSCHAFT", "TREUHAENDERSCHAFT_TREUUNTERNEHMEN", "ERBENGEMEINSCHAFT", "EUROPAEISCHE_GESELLSCHAFT", "GENOSSENSCHAFT", "AKTIENGESELLSCHAFT", "KOMMANDIT_AKTIENGESELLSCHAFT", "GMBH", "STIFTUNG", "VEREIN", "ANSTALT_LI", "FORMLOSER_BERICHT", "ZWEIGNIEDERL_AUSLAEND_GESELLSCH", "INSTITUT_DES_OEFFENTL_RECHTS" ]
          },
          "contactSalutation" : {
            "type" : "string",
            "description" : "a contact is a person representing the company",
            "enum" : [ "Mr", "Mrs" ]
          },
          "contactLastName" : {
            "maxLength" : 35,
            "minLength" : 2,
            "type" : "string",
            "description" : "a contact is a person representing the company"
          },
          "contactFirstName" : {
            "maxLength" : 35,
            "minLength" : 2,
            "type" : "string",
            "description" : "a contact is a person representing the company"
          },
          "address" : {
            "$ref" : "#/components/schemas/Address"
          }
        }
      },
      "Contract" : {
        "required" : [ "conditionMonthYear", "contractId", "creationDate", "endDate", "fileHandles", "paymentCode", "product", "roles", "startDate", "totalNetPrice" ],
        "type" : "object",
        "properties" : {
          "creationDate" : {
            "type" : "string",
            "description" : "the day the contract was issued",
            "format" : "date"
          },
          "startDate" : {
            "type" : "string",
            "description" : "start of contract which means start of insurance coverage",
            "format" : "date"
          },
          "endDate" : {
            "type" : "string",
            "description" : "end of contract which means end of insurance coverage",
            "format" : "date"
          },
          "contractId" : {
            "maxLength" : 20,
            "minLength" : 0,
            "type" : "string",
            "description" : "id given by SaaS provider"
          },
          "totalNetPrice" : {
            "$ref" : "#/components/schemas/MonetaryAmount"
          },
          "roles" : {
            "maxItems" : 99,
            "minItems" : 1,
            "type" : "array",
            "description" : "all roles in the contract, e.g. insuranceHolder",
            "items" : {
              "$ref" : "#/components/schemas/Role"
            }
          },
          "product" : {
            "$ref" : "#/components/schemas/Product"
          },
          "agent" : {
            "$ref" : "#/components/schemas/Agent"
          },
          "paymentCode" : {
            "type" : "integer",
            "description" : "a code uniquely identifying the type of payment e.g. invoice or creditcard, Paypal etc.",
            "format" : "int32"
          },
          "fileHandles" : {
            "maxItems" : 2,
            "minItems" : 1,
            "type" : "array",
            "description" : "a contract is only complete with its corresponding documents. This is the contract issued by the SaaS provider and maybe some further documents like e.g. customer provided documents like e.g. receipts. At least one contract document is required",
            "items" : {
              "$ref" : "#/components/schemas/FileHandle"
            }
          },
          "conditionMonthYear" : {
            "maxLength" : 4,
            "minLength" : 4,
            "type" : "string",
            "description" : "when was the condition issued? Format MMYY"
          }
        }
      },
      "Coverable" : {
        "required" : [ "code", "coverages" ],
        "type" : "object",
        "properties" : {
          "code" : {
            "type" : "integer",
            "description" : "a code uniquely identifying a type of coverable",
            "format" : "int32"
          },
          "coverages" : {
            "maxItems" : 99,
            "minItems" : 1,
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/Coverage"
            }
          }
        }
      },
      "Coverage" : {
        "required" : [ "code", "premium", "sumInsured" ],
        "type" : "object",
        "properties" : {
          "code" : {
            "type" : "integer",
            "description" : "a code uniquely identifying a type of coverage",
            "format" : "int32"
          },
          "premium" : {
            "$ref" : "#/components/schemas/MonetaryAmount"
          },
          "deductible" : {
            "$ref" : "#/components/schemas/MonetaryAmount"
          },
          "sumInsured" : {
            "$ref" : "#/components/schemas/MonetaryAmount"
          }
        }
      },
      "FileHandle" : {
        "required" : [ "handle" ],
        "type" : "object",
        "properties" : {
          "handle" : {
            "type" : "string",
            "description" : "Reference to an uploaded file. This can be e.g. a PDF or a picture (e.g. JPG) of a contract or a purchase receipt."
          }
        }
      },
      "MonetaryAmount" : {
        "required" : [ "amount" ],
        "type" : "object",
        "properties" : {
          "amount" : {
            "type" : "number",
            "description" : "An amount with two decimal digit like an insured sum or a deductible (e.g. 100,22)."
          }
        }
      },
      "Person" : {
        "required" : [ "address", "firstName", "language", "lastName", "salutation" ],
        "type" : "object",
        "properties" : {
          "salutation" : {
            "type" : "string",
            "enum" : [ "Mr", "Mrs" ]
          },
          "lastName" : {
            "maxLength" : 35,
            "minLength" : 2,
            "type" : "string"
          },
          "firstName" : {
            "maxLength" : 35,
            "minLength" : 2,
            "type" : "string"
          },
          "dateOfBirth" : {
            "type" : "string",
            "format" : "date"
          },
          "phoneNumber" : {
            "$ref" : "#/components/schemas/PhoneNumber"
          },
          "emailAddress" : {
            "maxLength" : 70,
            "minLength" : 2,
            "type" : "string",
            "description" : "A valid email address"
          },
          "language" : {
            "maxLength" : 2,
            "minLength" : 2,
            "type" : "string",
            "description" : "The language for correspondence with the customer. According to ISO 639-1 language codes, only the values 'de', 'fr', 'it' or 'en' are accepted."
          },
          "address" : {
            "$ref" : "#/components/schemas/Address"
          }
        }
      },
      "PhoneNumber" : {
        "required" : [ "phoneNumber" ],
        "type" : "object",
        "properties" : {
          "countryCode" : {
            "type" : "string",
            "description" : "Country code, default is +41."
          },
          "phoneNumber" : {
            "maxLength" : 20,
            "minLength" : 5,
            "type" : "string",
            "description" : "Phone number, without the leading zero."
          }
        }
      },
      "Product" : {
        "required" : [ "code", "coverables", "pricingMonthYear" ],
        "type" : "object",
        "properties" : {
          "code" : {
            "type" : "integer",
            "description" : "a code uniquely identifying the product",
            "format" : "int32"
          },
          "pricingMonthYear" : {
            "maxLength" : 4,
            "minLength" : 4,
            "type" : "string",
            "description" : "The month/year in which the pricing for the contract was set. Format MMYY"
          },
          "coverables" : {
            "maxItems" : 99,
            "minItems" : 1,
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/Coverable"
            }
          }
        }
      },
      "Role" : {
        "required" : [ "role" ],
        "type" : "object",
        "properties" : {
          "role" : {
            "type" : "string",
            "enum" : [ "insuranceholder", "payer" ]
          },
          "person" : {
            "$ref" : "#/components/schemas/Person"
          },
          "company" : {
            "$ref" : "#/components/schemas/Company"
          }
        }
      },
      "Document" : {
        "required" : [ "contractId", "data", "documentType", "fileName", "mediaType" ],
        "type" : "object",
        "properties" : {
          "data" : {
            "type" : "array",
            "description" : "the document itself",
            "items" : {
              "type" : "string",
              "format" : "byte"
            }
          },
          "contractId" : {
            "maxLength" : 20,
            "minLength" : 0,
            "type" : "string",
            "description" : "the contract this document belongs to"
          },
          "mediaType" : {
            "type" : "string",
            "description" : "accepted media types for documents represented by data byte[]",
            "enum" : [ "APPLICATION_PDF", "IMAGE_JPEG", "IMAGE_TIFF", "IMAGE_PNG", "IMAGE_BMP", "IMAGE_GIF" ]
          },
          "fileName" : {
            "maxLength" : 256,
            "minLength" : 0,
            "type" : "string"
          },
          "documentType" : {
            "type" : "string",
            "enum" : [ "CONTRACT", "RECEIPT" ]
          }
        }
      },
      "Version" : {
        "required" : [ "value" ],
        "type" : "object",
        "properties" : {
          "value" : {
            "type" : "string",
            "description" : "version identifier of the current API definition"
          }
        }
      }
    }
  }
}